@use '../variables/layout' as *;
@use '../variables/typography' as *;
@use 'sass:map';

// ============================================
// Mixins
// ============================================

// Flex mixin
@mixin flex($direction: row, $justify: flex-start, $align: stretch, $wrap: nowrap) {
  display: flex;
  flex-direction: $direction;
  justify-content: $justify;
  align-items: $align;
  flex-wrap: $wrap;
}

// 자주 사용하는 flex 패턴들
@mixin flex-center {
  @include flex(row, center, center);
}

@mixin flex-between {
  @include flex(row, space-between, center);
}

@mixin flex-column {
  @include flex(column, flex-start, stretch);
}

@mixin flex-column-center {
  @include flex(column, center, center);
}

@mixin tablet {
  @media (max-width: 900px) {
    @content;
  }
}

@mixin mobile {
  @media (max-width: 900px) {
    @content;
  }
}

@mixin desktop {
  @media (min-width: #{$breakpoint-lg}) {
    @content;
  }
}

@mixin respond-to($breakpoint) {
  @if $breakpoint == mobile {
    @media (max-width: #{$breakpoint-sm - 1px}) {
      @content;
    }
  }
  @if $breakpoint == tablet {
    @media (min-width: #{$breakpoint-sm}) and (max-width: #{$breakpoint-lg - 1px}) {
      @content;
    }
  }
  @if $breakpoint == desktop {
    @media (min-width: #{$breakpoint-lg}) {
      @content;
    }
  }
}

// 폰트 사이즈 mixin (rem 사용)
@mixin font-size($size, $line-height: 1.4) {
  font-size: to-rem($size);
  line-height: $line-height;
}

// 절대 위치 mixin
@mixin absolute($top: null, $right: null, $bottom: null, $left: null) {
  position: absolute;
  top: $top;
  right: $right;
  bottom: $bottom;
  left: $left;
}

// 상대 위치 mixin
@mixin relative($top: null, $right: null, $bottom: null, $left: null) {
  position: relative;
  top: $top;
  right: $right;
  bottom: $bottom;
  left: $left;
}

// 버튼 리셋 mixin
@mixin button-reset {
  border: none;
  background: none;
  padding: 0;
  margin: 0;
  font: inherit;
  color: inherit;
  cursor: pointer;
  outline: none;
  text-decoration: none;

  &:focus {
    outline: 2px solid transparent;
    outline-offset: 2px;
  }
}

// 버튼 mixin
@mixin button($bg-color, $text-color: white, $padding: to-rem(12) to-rem(24)) {
  @include button-reset;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: $padding;
  background-color: $bg-color;
  color: $text-color;
  border-radius: to-rem(8);
  transition: all 0.2s ease;

  &:hover {
    background-color: darken($bg-color, 10%);
  }
}

// 텍스트 truncate
@mixin text-truncate {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

// 멀티라인 텍스트 truncate
@mixin text-truncate-lines($lines: 2) {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: $lines;
  overflow: hidden;
}

// 그림자 mixin
@mixin shadow($level: 1) {
  @if $level == 1 {
    box-shadow:
      0 1px 3px rgba(0, 0, 0, 0.12),
      0 1px 2px rgba(0, 0, 0, 0.24);
  } @else if $level == 2 {
    box-shadow:
      0 3px 6px rgba(0, 0, 0, 0.16),
      0 3px 6px rgba(0, 0, 0, 0.23);
  } @else if $level == 3 {
    box-shadow:
      0 10px 20px rgba(0, 0, 0, 0.19),
      0 6px 6px rgba(0, 0, 0, 0.23);
  }
}

// 배경 이미지 mixin
@mixin bg-image($url, $size: cover, $position: center) {
  background-image: url($url);
  background-size: $size;
  background-position: $position;
  background-repeat: no-repeat;
}

// 페이지 타이틀 mixin
@mixin page-title($level: 'h2', $color: null) {
  // 직접 rem 값 매핑
  @if $level == 'h1' {
    font-size: 2.5rem; // 40px
  } @else if $level == 'h2' {
    font-size: 1.75rem; // 28px
  } @else if $level == 'h3' {
    font-size: 1.5rem; // 24px
  } @else if $level == 'h4' {
    font-size: 1.25rem; // 20px
  } @else if $level == 'h5' {
    font-size: 1.125rem; // 18px
  } @else {
    font-size: 1rem; // 16px
  }

  font-weight: map.get($page-title-weights, $level);
  line-height: map.get($page-title-line-heights, $level);
  margin: 0;

  @if $color {
    color: $color;
  }

  // 반응형 폰트 크기 조정
  @include mobile {
    @if $level == 'h1' {
      font-size: 2.125rem; // 40px * 0.85
    } @else if $level == 'h2' {
      font-size: 1.5rem; // 28px * 0.85
    } @else if $level == 'h3' {
      font-size: 1.275rem; // 24px * 0.85
    } @else if $level == 'h4' {
      font-size: 1.0625rem; // 20px * 0.85
    } @else if $level == 'h5' {
      font-size: 0.95625rem; // 18px * 0.85
    } @else {
      font-size: 0.85rem; // 16px * 0.85
    }
  }

  @include tablet {
    @if $level == 'h1' {
      font-size: 2.25rem; // 40px * 0.9
    } @else if $level == 'h2' {
      font-size: 1.575rem; // 28px * 0.9
    } @else if $level == 'h3' {
      font-size: 1.35rem; // 24px * 0.9
    } @else if $level == 'h4' {
      font-size: 1.125rem; // 20px * 0.9
    } @else if $level == 'h5' {
      font-size: 1.0125rem; // 18px * 0.9
    } @else {
      font-size: 0.9rem; // 16px * 0.9
    }
  }
}

@mixin sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  border: 0;
  padding: 0;
  white-space: nowrap;
  clip-path: inset(50%);
}

// 아이콘 맵 정의
$icon-map: (
  'book':
    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='23' viewBox='0 0 30 23' fill='none'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M13.4471 22.2451C8.5696 19.3212 4.15434 21.0508 2.64026 22.1864C2.31704 22.4288 1.8846 22.4678 1.52323 22.2871C1.16186 22.1064 0.933594 21.7371 0.933594 21.333V5.33304C0.933594 4.9973 1.09167 4.68115 1.36026 4.47971C3.33128 3.00144 8.39782 1.08275 13.9552 4.08017C16.3216 2.64629 21.2567 1.24299 26.5491 4.41838C26.8703 4.61115 27.0669 4.95836 27.0669 5.33304V21.333C27.0669 21.7173 26.8602 22.0719 26.5258 22.2613C26.1914 22.4506 25.781 22.4454 25.4515 22.2477C20.5772 19.3232 16.1638 21.0469 14.6449 22.1829C14.626 22.1972 14.6066 22.211 14.5866 22.2241C14.5181 22.2692 14.4453 22.3058 14.3699 22.3336C14.2464 22.3793 14.1164 22.4013 13.9868 22.3996C13.8782 22.3983 13.7698 22.3803 13.6655 22.3459C13.6069 22.3265 13.5496 22.3019 13.4942 22.272C13.4782 22.2634 13.4625 22.2544 13.4471 22.2451ZM3.06693 19.5042V5.89974C4.80767 4.84198 8.65682 3.6544 12.9336 5.95324V19.5806C8.98292 17.8442 5.36996 18.4852 3.06693 19.5042ZM15.0669 19.5042C17.37 18.4852 20.9829 17.8442 24.9336 19.5806V5.95324C20.6568 3.6544 16.8077 4.84198 15.0669 5.89974V19.5042Z' fill='%2333363D'/%3E%3Cellipse cx='24.668' cy='5.3335' rx='4' ry='4' fill='%233c79c2'/%3E%3Cellipse cx='24.6683' cy='5.33333' rx='5.33333' ry='5.33333' fill='%233c79c2'/%3E%3C/svg%3E",
  'printer':
    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='25' viewBox='0 0 24 25' fill='none'%3E%3Cpath d='M17.1992 2.5C17.641 2.5 17.9989 2.85807 17.999 3.2998V7.5H20.2031C21.1972 7.5 22.0028 8.30578 22.0029 9.2998V18.7002C22.0029 19.142 21.645 19.5 21.2031 19.5H17.999V21.7002C17.999 22.142 17.641 22.5 17.1992 22.5H6.99902C6.55729 22.4999 6.19922 22.142 6.19922 21.7002V19.5H2.7998C2.58766 19.4999 2.38436 19.4157 2.23438 19.2656C2.0844 19.1156 2 18.9123 2 18.7002L2.00293 9.2998C2.00323 8.30593 2.80888 7.50005 3.80273 7.5H6V3.2998C6.00011 2.85813 6.35813 2.50011 6.7998 2.5H17.1992ZM7.79883 20.9004H16.3994V15.2998H7.79883V20.9004ZM3.80273 9.09961C3.69239 9.09966 3.60264 9.18946 3.60254 9.2998L3.60059 17.9004H6.19922V14.5C6.19932 14.0583 6.55735 13.7003 6.99902 13.7002H17.1992C17.4113 13.7002 17.6146 13.7846 17.7646 13.9346C17.9146 14.0846 17.999 14.2879 17.999 14.5V17.9004H20.4033V9.2998C20.4032 9.18944 20.3135 9.09961 20.2031 9.09961H3.80273ZM7.59961 7.5H16.3994V4.09961H7.59961V7.5Z' fill='%2333363D'/%3E%3C/svg%3E",
  'person':
    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='25' height='25' viewBox='0 0 25 25' fill='none'%3E%3Cpath d='M4.89966 14.7637C8.64346 13.2094 12.8612 13.259 16.5676 14.9004L16.6604 14.9414C17.6734 15.39 18.3264 16.3941 18.3264 17.502V19.7002C18.3264 20.142 17.9684 20.5 17.5266 20.5H3.52661C3.08487 20.4999 2.72681 20.142 2.72681 19.7002V17.5352C2.7269 16.4036 3.40829 15.3831 4.45337 14.9492L4.89966 14.7637ZM15.9192 16.3633C12.6135 14.8995 8.85192 14.8559 5.51294 16.2422L5.06665 16.4268C4.6188 16.6127 4.32651 17.0503 4.32642 17.5352V18.9004H16.7268V17.502C16.7268 17.0272 16.447 16.5966 16.0129 16.4043L15.9192 16.3633ZM19.2258 6.5C19.6676 6.5 20.0255 6.85807 20.0256 7.2998V9.2002H21.926C22.3678 9.2002 22.7257 9.55826 22.7258 10C22.7258 10.4418 22.3679 10.7998 21.926 10.7998H20.0256V12.7002C20.0256 13.142 19.6677 13.5 19.2258 13.5C18.7841 13.4999 18.426 13.142 18.426 12.7002V10.7998H16.5266C16.0849 10.7997 15.7268 10.4418 15.7268 10C15.7269 9.55833 16.0849 9.2003 16.5266 9.2002H18.426V7.2998C18.4261 6.85813 18.7842 6.50011 19.2258 6.5ZM10.5266 4.5C12.6252 4.5 14.3263 6.20121 14.3264 8.2998C14.3264 10.3985 12.6253 12.0996 10.5266 12.0996C8.42802 12.0995 6.72681 10.3984 6.72681 8.2998C6.72691 6.20128 8.42808 4.50011 10.5266 4.5ZM10.5266 6.09961C9.31174 6.09971 8.32652 7.08493 8.32642 8.2998C8.32642 9.51477 9.31167 10.4999 10.5266 10.5C11.7416 10.5 12.7268 9.51483 12.7268 8.2998C12.7267 7.08487 11.7416 6.09961 10.5266 6.09961Z' fill='%234B4D4D'/%3E%3C/svg%3E",
  'download':
    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20' fill='none'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M10.4793 13.3787C10.3536 13.5095 10.18 13.5833 9.9987 13.5833C9.81735 13.5833 9.64383 13.5095 9.51814 13.3787L5.35148 9.04541C5.09628 8.78 5.10456 8.35797 5.36996 8.10278C5.63536 7.84758 6.05739 7.85586 6.31259 8.12126L9.33203 11.2615V3.16667C9.33203 2.79848 9.63051 2.5 9.9987 2.5C10.3669 2.5 10.6654 2.79848 10.6654 3.16667V11.2615L13.6848 8.12126C13.94 7.85586 14.362 7.84758 14.6274 8.10278C14.8928 8.35797 14.9011 8.78 14.6459 9.04541L10.4793 13.3787ZM3 13.3338C3.00009 12.9656 2.70169 12.6671 2.3335 12.667C1.96531 12.6669 1.66676 12.9653 1.66667 13.3335L1.66602 16.0002C1.66597 16.177 1.73619 16.3466 1.86122 16.4717C1.98625 16.5967 2.15584 16.667 2.33268 16.667H17.6654C18.0336 16.667 18.332 16.3685 18.332 16.0003V13.3337C18.332 12.9655 18.0336 12.667 17.6654 12.667C17.2972 12.667 16.9987 12.9655 16.9987 13.3337V15.3337H2.99951L3 13.3338Z' fill='%2333363D'/%3E%3C/svg%3E",
);

// 아이콘 mixin
@mixin icon($name, $size: to-rem(16), $width: null, $height: null) {
  // 크기 설정
  @if $width and $height {
    width: $width;
    height: $height;
  } @else {
    width: $size;
    height: $size;
  }

  // 아이콘 기본 스타일
  display: inline-block;
  vertical-align: middle;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;

  // 배경 이미지 설정
  @if map.has-key($icon-map, $name) {
    background-image: url(map.get($icon-map, $name));
  } @else {
    // 기본값으로 클래스 상속 시도
    @extend .icon-#{$name} !optional;
  }
}

// 위치 설정 mixin
@mixin position($position, $top: null, $right: null, $bottom: null, $left: null) {
  position: $position;
  top: $top;
  right: $right;
  bottom: $bottom;
  left: $left;
}

// before, after
// before, after
@mixin makeBefore {
  &::before {
    content: '';
    display: block;
    position: absolute;
    @content; // 이 줄 추가!
  }
}
@mixin makeAfter {
  &::after {
    content: '';
    display: block;
    position: absolute;
  }
}

// 폰트 스타일 mixin
@mixin font($size, $weight, $color) {
  font-size: $size;
  font-weight: $weight;
  color: $color;
}

// 반응형 이미지 mixin
@mixin responsive-image {
  max-width: 100%;
  height: auto; // 비율 유지
  display: block; // 이미지 하단 여백 제거
  object-fit: contain; // 이미지 비율 유지하면서 컨테이너에 맞춤
}
