@use '../globals' as *;

.left-menu {
	flex: 0 0 to-rem(280);
	position: sticky;
	top: 0;
	// height: 100vh;
	overflow: hidden;
	padding-bottom: to-rem(64);

	@include tablet {
		display: none;
	}
}

.left-menu-nav {
	height: 100%;
	overflow-y: auto;
	margin-top: to-rem(42);

	.left-menu-title {
		padding: to-rem(32) 0;
		border-bottom: 1px solid #b1b3b3;

		.left-menu-title-text {
			color: #1e2124;
			font-size: to-rem(24);
			font-weight: 700;
			margin-left: to-rem(10);

			@include tablet {
				font-size: to-rem(20);
			}
		}
	}

	.menu-section {
		border-bottom: 1px solid #e5e8eb;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: flex-start;
		width: 100%;
		&.is-active {
			.menu-section-title {
				border-bottom: 3px solid var(--color-primary-pr07, #244874);
				background: var(--color-action-secondary-selected, #eef2f7);
				box-sizing: border-box;
			}
			.menu-section-title .menu-title-text {
				color: var(--color-primary-pr08, #18304d);
			}
		}

		&:last-child {
			border-bottom: none;
		}

		.menu-section-title {
			width: 100%;
			min-height: 58px;
			@include flex;
			align-items: center;
			justify-content: space-between;
			font-size: to-rem(16);
			font-weight: 500;
			border: none;
			cursor: pointer;
			text-align: left;
			padding: 16px 0;
			padding-left: to-rem(20);
			padding-right: to-rem(20);
			position: relative;
			transition: all 0.25s ease-in-out;
			
			// 왼쪽에서 오른쪽으로 라인 애니메이션
			&::after {
				content: '';
				position: absolute;
				left: 0;
				bottom: 0;
				width: 0;
				height: 3px;
				background: var(--color-primary-pr07, #244874);
				transition: width 0.3s ease-out;
			}

			&:hover {
				background: #f3f4f6;
				color: $primary-color;
				
				&::after {
					width: 100%;
				}
			}

			&.expanded {
				background: var(--color-action-secondary-selected, #eef2f7);
				
				&::after {
					width: 100%;
				}
				
				.menu-title-text {
					color: var(--color-primary-pr08, #18304d);
				}

				.menu-arrow {
					transform: rotate(180deg);
				}
			}

			&.active,
			&.direct-link.active {
				background: #ECF2F9;
				color: $primary-color;
				
				&::after {
					width: 100%;
				}
			}

			&.direct-link {
				text-decoration: none;

				&:hover {
					background: #f3f4f6;
					color: $primary-color;
				}
			}

			.menu-title-text {
				flex: 1;
				font-size: to-rem(17);
				font-weight: 700;
				color: #1e2124;
			}

			.menu-arrow {
				flex-shrink: 0;
				transition: transform 0.3s ease-out;
			}
		}

		.menu-list {
			list-style: none;
			margin: 0;
			padding: 0;
			max-height: 0;
			overflow: hidden;
			opacity: 0;
		visibility: hidden;
			  // ⭐ 닫힐 때: 매우 빠르게
			  transition: max-height 0.12s cubic-bezier(0.6, 0, 1, 1),  // 급격한 가속
			  opacity 0.08s ease-in,                         // 빠른 페이드
			  visibility 0s linear 0.12s;
			background: #ffffff;
			width: 100%;

			&.expanded {
				max-height: 600px;
				opacity: 1;
				visibility: visible;
				margin: 10px 0;
				
				// 열릴 때: 부드럽게
				transition: max-height 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94),
							opacity 0.25s ease-out 0.1s,
							visibility 0s linear 0s;


			}

			 // 애니메이션 완료 후 최적화 해제
			 &:not(.expanding) {
				will-change: auto;
			}

			.menu-item {
				width: 100%;
				margin-bottom: 5px;
				&:last-child {
					margin-bottom: 0;
				}
				&.is-active {
					.menu-link {
						background: #d8e4f3;
						outline: none;
						border: none;
						span{
							font-weight: 700;
						}
					}
				}

				.menu-link {
					@include flex;
					align-items: center;
					padding: to-rem(16) to-rem(20) to-rem(16) to-rem(40);
					color: $gray-900;
					font-weight: 500;
					text-decoration: none;
					font-size: to-rem(17);
					line-height: 1;
					transition: all 0.2s ease-out;
					background: #ffffff;
					position: relative;
					border-radius: 0.375rem;

					&::before {
						content: '';
						position: absolute;
						left: 20px;
						top: 50%;
						transform: translateY(-50%);
						bottom: 0;
						width: 4px;
						height: 4px;
						border-radius: 50%;
						background: #323333;
					}

					&:hover {
						background: #ecf2f9;
					}
					// 클릭 효과 (활성화 시뮬레이션)
					&:active {
						background: #d8e4f3;
						outline: none;
						border: none;
					}

					&.selected,
					&.active {
						background: #ecf2f9;
						color: #18304d;
						
						.menu-link-text {
							font-weight: 700;
						}
					}
				}
			}
		}
	}
}

.left-menu-nav {
	&::-webkit-scrollbar {
		width: 4px;
	}

	&::-webkit-scrollbar-track {
		background: transparent;
	}

	&::-webkit-scrollbar-thumb {
		background: #cdd1d5;
		border-radius: 2px;

		&:hover {
			background: #b2b8bd;
		}
	}
}
