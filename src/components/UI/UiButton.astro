---
export interface Props {
	text?: string;
	variant?: 'primary' | 'secondary' | 'tertiary' | 'darkBlue' | 'darkGray' | 'gray' | 'text' | 'ghost';
	size?: 'xsmall' | 'small' | 'medium' | 'large' | 'xlarge';
	width?: string;
	height?: string;
	disabled?: boolean;
	loading?: boolean;
	href?: string;
	target?: string;
	icon?: string;
	iconAddClass?: string;
	iconPosition?: 'left' | 'right';
	iconOnly?: boolean;
	class?: string;
	// ðŸ‘‡ ëª¨ë‹¬ ê´€ë ¨ ì†ì„±ë“¤ ì¶”ê°€
	'data-modal-open'?: string;
	'data-modal-close'?: boolean;
	'data-modal-confirm'?: boolean;
	// ðŸ‘‡ onclick ì´ë²¤íŠ¸ ì¶”ê°€
	onclick?: string;
}

const {
	text = 'ë²„íŠ¼',
	variant = 'primary',
	size = 'medium',
	width,
	height,
	disabled = false,
	loading = false,
	href,
	target,
	icon,
	iconAddClass,
	iconPosition = 'right',
	iconOnly = false,
	class: className = '',
	// ðŸ‘‡ ëª¨ë‹¬ ê´€ë ¨ ì†ì„±ë“¤ ì²˜ë¦¬
	'data-modal-open': dataModalOpen,
	'data-modal-close': dataModalClose,
	'data-modal-confirm': dataModalConfirm,
	// ðŸ‘‡ onclick ì´ë²¤íŠ¸ ì²˜ë¦¬
	onclick,
} = Astro.props;

const Tag = href ? 'a' : 'button';
const linkProps = href ? { href, target } : {};
const buttonProps = href
	? {}
	: {
			type: 'button',
			disabled: disabled || loading,
			// ëª¨ë‹¬ ê´€ë ¨ ë°ì´í„° ì†ì„±ë“¤ ì¶”ê°€
			...(dataModalOpen && { 'data-modal-open': dataModalOpen }),
			...(dataModalClose && { 'data-modal-close': '' }),
			...(dataModalConfirm && { 'data-modal-confirm': '' }),
			// onclick ì´ë²¤íŠ¸ ì¶”ê°€
			...(onclick && { onclick }),
	  };

const hasIcon = icon && icon.length > 0;
const hasText = text && text.length > 0 && !iconOnly;

// ë™ì  í¬ê¸°ë¥¼ í´ëž˜ìŠ¤ë¡œ ë³€í™˜
const getSizeClass = value => {
	if (!value) return '';
	const numValue = typeof value === 'number' ? value : parseInt(value);
	if (numValue <= 100) return `w-dynamic-${numValue}`;
	return `container-w-${Math.round(numValue / 10) * 10}`;
};

const getHeightClass = value => {
	if (!value) return '';
	const numValue = typeof value === 'number' ? value : parseInt(value);
	if (numValue <= 100) return `h-dynamic-${numValue}`;
	return `h-dynamic-${numValue}`;
};

const buttonClasses = [
	'ui-button',
	`ui-button--${variant}`,
	`ui-button--${size}`,
	iconOnly ? 'ui-button--icon-only' : '',
	loading ? 'ui-button--loading' : '',
	disabled ? 'ui-button--disabled' : '',
	width ? getSizeClass(width) : '',
	height ? getHeightClass(height) : '',
	className,
]
	.filter(Boolean)
	.join(' ');
---

<Tag class={buttonClasses} aria-disabled={disabled || loading} {...linkProps} {...buttonProps}>
	{
		loading && (
			<div class="ui-button__spinner">
				<img class="ui-button__spinner-icon" src="./assets/images/icon/icon-spinner.svg" alt="ë¡œë”© ì¤‘" />
			</div>
		)
	}

	{
		hasIcon && iconPosition === 'left' && !loading && (
			<div class="ui-button__icon ui-button__icon--left">
				<img src={`./assets/images/icon/${icon}.svg`} class={`icon icon-md ${iconAddClass}`} />
			</div>
		)
	}

	{hasText && <span class="ui-button__text">{text}</span>}

	{
		hasIcon && iconPosition === 'right' && !loading && (
			<div class="ui-button__icon ui-button__icon--right">
				<img src={`./assets/images/icon/${icon}.svg`} class={`icon icon-sm ${iconAddClass}`} />
			</div>
		)
	}
</Tag>
